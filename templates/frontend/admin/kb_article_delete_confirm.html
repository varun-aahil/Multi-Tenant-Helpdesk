{% extends 'frontend/base.html' %}

{% block title %}Delete Article - Admin Panel{% endblock %}

{% block content %}
<div style="max-width: 600px; margin: 0 auto;">
    <div class="card">
        <h2 style="margin-bottom: 0.5rem; color: #ef4444; border-bottom: 2px solid #ef4444; padding-bottom: 1rem;">Delete Article</h2>
        <p style="color: #6b7280; margin-bottom: 2rem;">Are you sure you want to delete this article? This action cannot be undone.</p>
        
        <div style="background: rgba(239, 68, 68, 0.1); border: 1px solid rgba(239, 68, 68, 0.3); border-radius: 8px; padding: 1.5rem; margin-bottom: 2rem;">
            <h3 style="color: #f8fafc; margin-bottom: 0.5rem;">{{ article.title }}</h3>
            <p style="color: #94a3b8; margin: 0;">{{ article.content|truncatewords:30 }}</p>
            <div style="margin-top: 1rem; display: flex; gap: 1rem; flex-wrap: wrap;">
                <span style="color: #94a3b8; font-size: 0.875rem;">
                    <strong>Category:</strong> {{ article.category|default:"‚Äî" }}
                </span>
                <span style="color: #94a3b8; font-size: 0.875rem;">
                    <strong>Published:</strong> {% if article.is_published %}Yes{% else %}No{% endif %}
                </span>
                <span style="color: #94a3b8; font-size: 0.875rem;">
                    <strong>Views:</strong> {{ article.view_count }}
                </span>
            </div>
        </div>
        
        <form method="post" id="deleteForm">
            {% csrf_token %}
            <input type="hidden" name="token" id="tokenInput">
            
            <div style="display: flex; gap: 1rem; margin-top: 2rem; padding-top: 1.5rem; border-top: 2px solid #e5e7eb;">
                <button type="submit" class="btn btn-danger">üóëÔ∏è Delete Article</button>
                <a href="{% url 'admin_knowledge_base' %}" class="btn btn-secondary">Cancel</a>
            </div>
        </form>
    </div>
</div>

<script>
// Add token to form on load
document.addEventListener('DOMContentLoaded', function() {
    const token = window.getPortalToken ? window.getPortalToken() : localStorage.getItem('access_token');
    if (token) {
        const tokenInput = document.getElementById('tokenInput');
        if (tokenInput) tokenInput.value = token;
    } else {
        // Redirect to login if no token
        window.location.href = '{% url "admin_login" %}';
    }
    
    // Confirm before submit
    document.getElementById('deleteForm').addEventListener('submit', function(e) {
        if (!confirm('Are you absolutely sure you want to delete this article? This action cannot be undone.')) {
            e.preventDefault();
        }
    });
});
</script>
{% endblock %}

