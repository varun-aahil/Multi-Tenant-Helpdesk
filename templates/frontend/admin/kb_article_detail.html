{% extends 'frontend/base.html' %}

{% block title %}Edit Article - Admin Panel{% endblock %}

{% block content %}
<div style="max-width: 1000px; margin: 0 auto;">
    <div class="card">
        <h2 style="margin-bottom: 0.5rem; color: #1f2937; border-bottom: 2px solid #e5e7eb; padding-bottom: 1rem;">Edit Knowledge Base Article</h2>
        <p style="color: #6b7280; margin-bottom: 2rem;">Update article details and content</p>
        
        <form method="post" id="editArticleForm">
            {% csrf_token %}
            <input type="hidden" name="token" id="tokenInput">
            
            <div class="form-group">
                <label for="title">Title *</label>
                <input type="text" id="title" name="title" value="{{ article.title }}" required placeholder="Enter article title">
            </div>
            
            <div class="form-group">
                <label for="category">Category</label>
                <input type="text" id="category" name="category" value="{{ article.category|default:'' }}" placeholder="e.g., General, FAQ, Troubleshooting">
            </div>
            
            <div class="form-group">
                <label for="content">Content *</label>
                <textarea id="content" name="content" required style="min-height: 400px; font-family: inherit;" placeholder="Enter article content...">{{ article.content }}</textarea>
            </div>
            
            <div class="form-group">
                <label style="display: flex; align-items: center; gap: 0.75rem; cursor: pointer; padding: 1rem; background: #f9fafb; border-radius: 8px; border: 2px solid #e5e7eb; transition: all 0.3s;">
                    <input type="checkbox" name="is_published" {% if article.is_published %}checked{% endif %} style="width: 20px; height: 20px; cursor: pointer;">
                    <span style="font-weight: 600; color: #374151;">Publish this article</span>
                </label>
            </div>
            
            <div style="display: flex; gap: 1rem; margin-top: 2rem; padding-top: 1.5rem; border-top: 2px solid #e5e7eb;">
                <button type="submit" class="btn btn-primary">ðŸ’¾ Save Changes</button>
                <a href="{% url 'admin_knowledge_base' %}" class="btn btn-secondary">Cancel</a>
            </div>
        </form>
    </div>
</div>

<script>
// Add token to form on load
document.addEventListener('DOMContentLoaded', function() {
    const token = window.getPortalToken ? window.getPortalToken() : localStorage.getItem('access_token');
    if (token) {
        const tokenInput = document.getElementById('tokenInput');
        if (tokenInput) tokenInput.value = token;
    } else {
        // Redirect to login if no token
        window.location.href = '{% url "admin_login" %}';
    }
});
</script>
{% endblock %}

